<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>upkie: upkie.envs.upkie_base_env.UpkieBaseEnv Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">upkie
   &#160;<span id="projectnumber">3.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">upkie.envs.upkie_base_env.UpkieBaseEnv Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Base class for Upkie environments.  
 <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9a52349d01d27c9f97fe8fdc2b8cc3ec"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a9a52349d01d27c9f97fe8fdc2b8cc3ec">__init__</a> (self, float <a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a1cc38c6e11f9b8bd2c5c3c4499ba7edc">fall_pitch</a>=1.0, Optional[float] <a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a0af239450ca67c0381e8898af17b174d">frequency</a>=200.0, Optional[<a class="el" href="classupkie_1_1utils_1_1robot__state_1_1RobotState.html">RobotState</a>] <a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a56641dc3888c28cda9ec0777f048db7d">init_state</a>=None, bool regulate_frequency=True, str shm_name=&quot;/vulp&quot;, Optional[dict] spine_config=None, int spine_retries=10)</td></tr>
<tr class="memdesc:a9a52349d01d27c9f97fe8fdc2b8cc3ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize environment.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a9a52349d01d27c9f97fe8fdc2b8cc3ec">More...</a><br /></td></tr>
<tr class="separator:a9a52349d01d27c9f97fe8fdc2b8cc3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26d4d755da82237864eda88cd29334fa"><td class="memItemLeft" align="right" valign="top">Optional[float]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a26d4d755da82237864eda88cd29334fa">dt</a> (self)</td></tr>
<tr class="memdesc:a26d4d755da82237864eda88cd29334fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regulated period of the control loop in seconds, or <code>None</code> if there is no loop frequency regulation.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a26d4d755da82237864eda88cd29334fa">More...</a><br /></td></tr>
<tr class="separator:a26d4d755da82237864eda88cd29334fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af239450ca67c0381e8898af17b174d"><td class="memItemLeft" align="right" valign="top">Optional[float]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a0af239450ca67c0381e8898af17b174d">frequency</a> (self)</td></tr>
<tr class="memdesc:a0af239450ca67c0381e8898af17b174d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regulated frequency of the control loop in Hz, or <code>None</code> if there is no loop frequency regulation.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a0af239450ca67c0381e8898af17b174d">More...</a><br /></td></tr>
<tr class="separator:a0af239450ca67c0381e8898af17b174d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab503d17424ef6139fa81cd3d43616787"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#ab503d17424ef6139fa81cd3d43616787">update_init_rand</a> (self, **kwargs)</td></tr>
<tr class="memdesc:ab503d17424ef6139fa81cd3d43616787"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update initial-state randomization.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#ab503d17424ef6139fa81cd3d43616787">More...</a><br /></td></tr>
<tr class="separator:ab503d17424ef6139fa81cd3d43616787"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2599a019384b06a16703531c2e52dcc6"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a2599a019384b06a16703531c2e52dcc6">close</a> (self)</td></tr>
<tr class="memdesc:a2599a019384b06a16703531c2e52dcc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the spine properly.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a2599a019384b06a16703531c2e52dcc6">More...</a><br /></td></tr>
<tr class="separator:a2599a019384b06a16703531c2e52dcc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1fdafa0e9e3261ce704d06ba639f3c0"><td class="memItemLeft" align="right" valign="top">Tuple[NDArray[float], dict]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa1fdafa0e9e3261ce704d06ba639f3c0">reset</a> (self, *Optional[int] seed=None, Optional[dict] options=None)</td></tr>
<tr class="memdesc:aa1fdafa0e9e3261ce704d06ba639f3c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the spine and get an initial observation.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa1fdafa0e9e3261ce704d06ba639f3c0">More...</a><br /></td></tr>
<tr class="separator:aa1fdafa0e9e3261ce704d06ba639f3c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa38212b7e4b9aee7195a335aca5a6424"><td class="memItemLeft" align="right" valign="top">Tuple[NDArray[float], float, bool, bool, dict]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa38212b7e4b9aee7195a335aca5a6424">step</a> (self, NDArray[float] action)</td></tr>
<tr class="memdesc:aa38212b7e4b9aee7195a335aca5a6424"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run one timestep of the environment's dynamics.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa38212b7e4b9aee7195a335aca5a6424">More...</a><br /></td></tr>
<tr class="separator:aa38212b7e4b9aee7195a335aca5a6424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6d49caa5b6ee4569518dc27cb75f8e4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#ac6d49caa5b6ee4569518dc27cb75f8e4">detect_fall</a> (self, dict spine_observation)</td></tr>
<tr class="memdesc:ac6d49caa5b6ee4569518dc27cb75f8e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detect a fall based on the body-to-world pitch angle.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#ac6d49caa5b6ee4569518dc27cb75f8e4">More...</a><br /></td></tr>
<tr class="separator:ac6d49caa5b6ee4569518dc27cb75f8e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2a65ff93ee171c00abcbece4cc58c89"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#af2a65ff93ee171c00abcbece4cc58c89">parse_first_observation</a> (self, dict spine_observation)</td></tr>
<tr class="memdesc:af2a65ff93ee171c00abcbece4cc58c89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse first observation after the spine interface is initialized.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#af2a65ff93ee171c00abcbece4cc58c89">More...</a><br /></td></tr>
<tr class="separator:af2a65ff93ee171c00abcbece4cc58c89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd5172da18c6944f80bd9ec59c898bee"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#acd5172da18c6944f80bd9ec59c898bee">get_env_observation</a> (self, dict spine_observation)</td></tr>
<tr class="memdesc:acd5172da18c6944f80bd9ec59c898bee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract environment observation from spine observation dictionary.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#acd5172da18c6944f80bd9ec59c898bee">More...</a><br /></td></tr>
<tr class="separator:acd5172da18c6944f80bd9ec59c898bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e4f2c1de7e487c6d2aa06aca00c173c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a9e4f2c1de7e487c6d2aa06aca00c173c">get_reward</a> (self, observation, action)</td></tr>
<tr class="memdesc:a9e4f2c1de7e487c6d2aa06aca00c173c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get reward from observation and action.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a9e4f2c1de7e487c6d2aa06aca00c173c">More...</a><br /></td></tr>
<tr class="separator:a9e4f2c1de7e487c6d2aa06aca00c173c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1f0dc9d7ee392aa37eb428269093274"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa1f0dc9d7ee392aa37eb428269093274">get_spine_action</a> (self, action)</td></tr>
<tr class="memdesc:aa1f0dc9d7ee392aa37eb428269093274"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert environment action to a spine action dictionary.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa1f0dc9d7ee392aa37eb428269093274">More...</a><br /></td></tr>
<tr class="separator:aa1f0dc9d7ee392aa37eb428269093274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94e9fa89d0bfb6d20263c620fd438411"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a94e9fa89d0bfb6d20263c620fd438411">log</a> (self, dict new_log)</td></tr>
<tr class="memdesc:a94e9fa89d0bfb6d20263c620fd438411"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log anything to the action dictionary.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a94e9fa89d0bfb6d20263c620fd438411">More...</a><br /></td></tr>
<tr class="separator:a94e9fa89d0bfb6d20263c620fd438411"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a1cc38c6e11f9b8bd2c5c3c4499ba7edc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a1cc38c6e11f9b8bd2c5c3c4499ba7edc">fall_pitch</a></td></tr>
<tr class="separator:a1cc38c6e11f9b8bd2c5c3c4499ba7edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56641dc3888c28cda9ec0777f048db7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a56641dc3888c28cda9ec0777f048db7d">init_state</a></td></tr>
<tr class="separator:a56641dc3888c28cda9ec0777f048db7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class for Upkie environments. </p>
<h3><a class="anchor" id="autotoc_md17"></a>
Attributes</h3>
<p>This base environment has the following attributes:</p>
<ul>
<li><code>fall_pitch</code>: Fall pitch angle, in radians.</li>
<li><code>init_state</code>: Initial state for the floating base of the robot, which may be randomized upon resets.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This environment is made to run on a single CPU thread rather than on GPU/TPU. The downside for reinforcement learning is that computations are not massively parallel. The upside is that it simplifies deployment to the real robot, as it relies on the same spine interface that runs on Upkie. </dd></dl>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00023">23</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9a52349d01d27c9f97fe8fdc2b8cc3ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a52349d01d27c9f97fe8fdc2b8cc3ec">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None upkie.envs.upkie_base_env.UpkieBaseEnv.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>fall_pitch</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[float] &#160;</td>
          <td class="paramname"><em>frequency</em> = <code>200.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[<a class="el" href="classupkie_1_1utils_1_1robot__state_1_1RobotState.html">RobotState</a>] &#160;</td>
          <td class="paramname"><em>init_state</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>regulate_frequency</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str &#160;</td>
          <td class="paramname"><em>shm_name</em> = <code>&quot;/vulp&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[dict] &#160;</td>
          <td class="paramname"><em>spine_config</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>spine_retries</em> = <code>10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize environment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fall_pitch</td><td>Fall detection pitch angle, in radians. </td></tr>
    <tr><td class="paramname">frequency</td><td>Regulated frequency of the control loop, in Hz. Can be set even when <code>regulate_frequency</code> is false, as some environments make use of e.g. <code>self.dt</code> internally. </td></tr>
    <tr><td class="paramname">init_state</td><td>Initial state of the robot, only used in simulation. </td></tr>
    <tr><td class="paramname">regulate_frequency</td><td>Enables loop frequency regulation. </td></tr>
    <tr><td class="paramname">shm_name</td><td>Name of shared-memory file to exchange with the spine. </td></tr>
    <tr><td class="paramname">spine_config</td><td>Additional spine configuration overriding the defaults from <code>//config:spine.yaml</code>. The combined configuration dictionary is sent to the spine at every :func:<code>reset</code>. </td></tr>
    <tr><td class="paramname">spine_retries</td><td>Number of times to try opening the shared-memory file to communicate with the spine. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00051">51</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2599a019384b06a16703531c2e52dcc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2599a019384b06a16703531c2e52dcc6">&#9670;&nbsp;</a></span>close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None upkie.envs.upkie_base_env.UpkieBaseEnv.close </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the spine properly. </p>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00121">121</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="ac6d49caa5b6ee4569518dc27cb75f8e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6d49caa5b6ee4569518dc27cb75f8e4">&#9670;&nbsp;</a></span>detect_fall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool upkie.envs.upkie_base_env.UpkieBaseEnv.detect_fall </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>spine_observation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detect a fall based on the body-to-world pitch angle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spine_observation</td><td>Observation dictionary with an "imu" key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if and only if a fall is detected. </dd></dl>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00220">220</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="a26d4d755da82237864eda88cd29334fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26d4d755da82237864eda88cd29334fa">&#9670;&nbsp;</a></span>dt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Optional[float] upkie.envs.upkie_base_env.UpkieBaseEnv.dt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regulated period of the control loop in seconds, or <code>None</code> if there is no loop frequency regulation. </p>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00097">97</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="a0af239450ca67c0381e8898af17b174d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0af239450ca67c0381e8898af17b174d">&#9670;&nbsp;</a></span>frequency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Optional[float] upkie.envs.upkie_base_env.UpkieBaseEnv.frequency </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regulated frequency of the control loop in Hz, or <code>None</code> if there is no loop frequency regulation. </p>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00105">105</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="acd5172da18c6944f80bd9ec59c898bee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd5172da18c6944f80bd9ec59c898bee">&#9670;&nbsp;</a></span>get_env_observation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upkie.envs.upkie_base_env.UpkieBaseEnv.get_env_observation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>spine_observation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract environment observation from spine observation dictionary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spine_observation</td><td>Spine observation dictionary. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Environment observation. </dd></dl>

<p>Reimplemented in <a class="el" href="classupkie_1_1envs_1_1upkie__servos_1_1UpkieServos.html#afe7bda5a7575cc479fa21a85345aa19f">upkie.envs.upkie_servos.UpkieServos</a>, and <a class="el" href="classupkie_1_1envs_1_1upkie__ground__velocity_1_1UpkieGroundVelocity.html#af142cc24663202587055d5458718b4d8">upkie.envs.upkie_ground_velocity.UpkieGroundVelocity</a>.</p>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00242">242</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="a9e4f2c1de7e487c6d2aa06aca00c173c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e4f2c1de7e487c6d2aa06aca00c173c">&#9670;&nbsp;</a></span>get_reward()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> float upkie.envs.upkie_base_env.UpkieBaseEnv.get_reward </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get reward from observation and action. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">observation</td><td>Environment observation. </td></tr>
    <tr><td class="paramname">action</td><td>Environment action. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reward. </dd></dl>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00251">251</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="aa1f0dc9d7ee392aa37eb428269093274"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1f0dc9d7ee392aa37eb428269093274">&#9670;&nbsp;</a></span>get_spine_action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> dict upkie.envs.upkie_base_env.UpkieBaseEnv.get_spine_action </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert environment action to a spine action dictionary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td>Environment action. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Spine action dictionary. </dd></dl>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00261">261</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="a94e9fa89d0bfb6d20263c620fd438411"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94e9fa89d0bfb6d20263c620fd438411">&#9670;&nbsp;</a></span>log()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None upkie.envs.upkie_base_env.UpkieBaseEnv.log </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>new_log</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Log anything to the action dictionary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_log</td><td>New log entry. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00269">269</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="af2a65ff93ee171c00abcbece4cc58c89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2a65ff93ee171c00abcbece4cc58c89">&#9670;&nbsp;</a></span>parse_first_observation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None upkie.envs.upkie_base_env.UpkieBaseEnv.parse_first_observation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>spine_observation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse first observation after the spine interface is initialized. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spine_observation</td><td>First observation.</td></tr>
  </table>
  </dd>
</dl>
<p>This method is an optional way for environments to record some state (abstracted away from the agnet) at reset. </p>

<p>Reimplemented in <a class="el" href="classupkie_1_1envs_1_1upkie__ground__velocity_1_1UpkieGroundVelocity.html#a5e40aeca5b2997afd78acb2f70c9d1db">upkie.envs.upkie_ground_velocity.UpkieGroundVelocity</a>.</p>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00231">231</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="aa1fdafa0e9e3261ce704d06ba639f3c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1fdafa0e9e3261ce704d06ba639f3c0">&#9670;&nbsp;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Tuple[NDArray[float], dict] upkie.envs.upkie_base_env.UpkieBaseEnv.reset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*Optional[int] &#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[dict] &#160;</td>
          <td class="paramname"><em>options</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the spine and get an initial observation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seed</td><td>Number used to initialize the environmentâ€™s internal random number generator. </td></tr>
    <tr><td class="paramname">options</td><td>Currently unused. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><code>observation</code>: Initial vectorized observation, i.e. an element of the environment's <code>observation_space</code>.</li>
<li><code>info</code>: Dictionary with auxiliary diagnostic information. For Upkie this is the full observation dictionary sent by the spine. </li>
</ul>
</dd></dl>

<p>Reimplemented in <a class="el" href="classupkie_1_1envs_1_1upkie__ground__velocity_1_1UpkieGroundVelocity.html#acd5c70c4a25d177bdcb9364ce79d3903">upkie.envs.upkie_ground_velocity.UpkieGroundVelocity</a>.</p>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00127">127</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="aa38212b7e4b9aee7195a335aca5a6424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa38212b7e4b9aee7195a335aca5a6424">&#9670;&nbsp;</a></span>step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Tuple[NDArray[float], float, bool, bool, dict] upkie.envs.upkie_base_env.UpkieBaseEnv.step </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NDArray[float]&#160;</td>
          <td class="paramname"><em>action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run one timestep of the environment's dynamics. </p>
<p>When the end of the episode is reached, you are responsible for calling <code><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa1fdafa0e9e3261ce704d06ba639f3c0" title="Resets the spine and get an initial observation.">reset()</a></code> to reset the environment's state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td>Action from the agent. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><code>observation</code>: Observation of the environment, i.e. an element of its <code>observation_space</code>.</li>
<li><code>reward</code>: Reward returned after taking the action.</li>
<li><code>terminated</code>: Whether the agent reached a terminal state, which can be a good or a bad thing. When true, the user needs to call :func:<code><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa1fdafa0e9e3261ce704d06ba639f3c0" title="Resets the spine and get an initial observation.">reset()</a></code>.</li>
<li>`&lsquo;truncated&rsquo;': Whether the episode is reaching max number of steps. This boolean can signal a premature end of the episode, i.e. before a terminal state is reached. When true, the user needs to call :func:<code><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa1fdafa0e9e3261ce704d06ba639f3c0" title="Resets the spine and get an initial observation.">reset()</a></code>.</li>
<li><code>info</code>: Dictionary with auxiliary diagnostic information. For us this is the full observation dictionary coming from the spine. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00178">178</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="ab503d17424ef6139fa81cd3d43616787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab503d17424ef6139fa81cd3d43616787">&#9670;&nbsp;</a></span>update_init_rand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None upkie.envs.upkie_base_env.UpkieBaseEnv.update_init_rand </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update initial-state randomization. </p>
<p>Keyword arguments are forwarded as is to <a class="el" href="classupkie_1_1utils_1_1robot__state__randomization_1_1RobotStateRandomization.html#a89e67ce737f68e5d4c06e71a66310c5b">upkie.utils.robot_state_randomization.RobotStateRandomization.update</a>. </p>

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00112">112</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a1cc38c6e11f9b8bd2c5c3c4499ba7edc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc38c6e11f9b8bd2c5c3c4499ba7edc">&#9670;&nbsp;</a></span>fall_pitch</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upkie.envs.upkie_base_env.UpkieBaseEnv.fall_pitch</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00093">93</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<a id="a56641dc3888c28cda9ec0777f048db7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56641dc3888c28cda9ec0777f048db7d">&#9670;&nbsp;</a></span>init_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upkie.envs.upkie_base_env.UpkieBaseEnv.init_state</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="upkie__base__env_8py_source.html#l00094">94</a> of file <a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>upkie/envs/<a class="el" href="upkie__base__env_8py_source.html">upkie_base_env.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>upkie</b></li><li class="navelem"><a class="el" href="namespaceupkie_1_1envs.html">envs</a></li><li class="navelem"><a class="el" href="namespaceupkie_1_1envs_1_1upkie__base__env.html">upkie_base_env</a></li><li class="navelem"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html">UpkieBaseEnv</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
