<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>upkie: Spines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">upkie
   &#160;<span id="projectnumber">3.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('spines.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Spines </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_docs_spines"></a> Upkie's code is organized into <em>spines</em>, which communicate with the simulation or mjbots actuators, and <em>agents</em>, the programs that implement robot behaviors. We use <a href="https://bazel.build/">Bazel</a> to build spines, both for simulation on your development computer or for running on the robot's Raspberry Pi. Bazel does not install anything on your system: it fetches dependencies with specific versions and builds them locally, making sure the code stays consistent over time. Check out <a href="https://github.com/upkie/vulp#readme">this introduction</a> for more details.</p>
<h1><a class="anchor" id="bullet-spine"></a>
Bullet spine</h1>
<p>The Bullet spine runs an agent in the <a href="https://github.com/bulletphysics/bullet3">Bullet 3</a> simulator. We can start this spine as a standalone process and let it run waiting for agents to connect:</p>
<div class="fragment"><div class="line">./start_simulation.sh</div>
</div><!-- fragment --><p>This script is just an alias for a Bazel <code>run</code> command:</p>
<div class="fragment"><div class="line">./tools/bazelisk run //spines:bullet_spine -- --show</div>
</div><!-- fragment --><p>Check out simulation options (fly like an eagle!) with the help flag <code>-h</code>.</p>
<h1><a class="anchor" id="pi3hat-spine"></a>
pi3hat spine</h1>
<p>The pi3hat spine is the one that runs on the real robot, where a <a href="https://mjbots.com/products/mjbots-pi3hat-r4-5">pi3hat r4.5</a> is mounted on top of the onboard Raspberry Pi computer. To run this spine, we can either: download it from GitHub, or build it locally from source.</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Download the latest release</h2>
<p>To get the latest pi3hat spine from GitHub, download the latest <code>pi3hat_spine</code> binary from <a href="https://github.com/upkie/upkie/actions/workflows/bazel.yml">Continuous Integration build artifacts</a>, then <code>scp</code> it to the robot. TODO: make this more user-friendly ;)</p>
<div class="fragment"><div class="line">$ scp pi3hat_spine foo@robot</div>
<div class="line">$ ssh foo@robot</div>
<div class="line">foo@robot:~$ ./pi3hat_spine</div>
</div><!-- fragment --><p>Once the spine is running, you can run any agent in a separate shell on the robot, for example the wheel balancer:</p>
<div class="fragment"><div class="line">foo@robot:upkie$ make run_pid_balancer</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16"></a>
Build from source</h2>
<p>To build the pi3hat locally from source, then upload it to Raspberry Pi, use the Makefile at the root of the repository:</p>
<div class="fragment"><div class="line">make build</div>
<div class="line">make upload UPKIE_NAME=your_upkie</div>
</div><!-- fragment --><p>Next, log into the Pi and run a pi3hat spine:</p>
<div class="fragment"><div class="line">$ ssh foo@robot</div>
<div class="line">foo@robot:~$ cd upkie</div>
<div class="line">foo@robot:upkie$ make run_pi3hat_spine</div>
</div><!-- fragment --><p>Once the spine is running, you can run any agent in a separate shell on the robot, for example the wheel balancer:</p>
<div class="fragment"><div class="line">foo@robot:upkie$ make run_pid_balancer</div>
</div><!-- fragment --><h1><a class="anchor" id="mock-spine"></a>
Mock spine</h1>
<p>The mock spine is useful to run an agent on the robot without firing up the actuators. It works exactly as the pi3hat spine, replacing "pi3hat" with "mock" in all instructions above. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
